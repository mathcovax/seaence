// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
    provider        = "prisma-client-js"
    output          = "../../../../node_modules/@prisma/output"
    previewFeatures = ["prismaSchemaFolder"]
}

generator json {
    provider = "prisma-json-types-generator"
}

datasource db {
    provider = "postgresql"
    url      = env("POSTGRES_DATABASE_URL")
}

enum provider {
    pubmed
}

model articleReference {
    value        String
    provider     provider
    failedToSend Boolean  @default(false)
    createdAt    DateTime @default(now())

    @@id([value, provider], name: "id")
}

enum exportArticleReferenceMissionStatus {
    inProgress
    failed
    success
}

model exportOneArticleReferenceMission {
    id             String                              @id @unique
    status         exportArticleReferenceMissionStatus
    provider       provider
    referenceValue String
}

model exportManyArticleReferenceMission {
    id                     String                              @id @unique
    status                 exportArticleReferenceMissionStatus
    concurrency            Int
    quantityProcessed      Int
    /// [ExportManyArticleReferenceMissionFailedArticleReference]
    failedArticleReference Json?
}

enum fetchArticleReferenceMissionStatus {
    created
    inRecovery
    inProgress
    failed
    success
}

model pubmedFetchArticleReferenceMission {
    id              String                             @id @unique
    articleType     articleType
    status          fetchArticleReferenceMissionStatus
    intervalFrom    DateTime
    intervalTo      DateTime
    currentStepDate DateTime
    currentStepPage Int
}
